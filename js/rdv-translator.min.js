document.addEventListener('DOMContentLoaded',function(){const MyMemoryTranslator={supportedLanguages:{en:"English",es:"Spanish",fr:"French",de:"German",it:"Italian",pt:"Portuguese",ru:"Russian",zh:"Chinese",ja:"Japanese",ko:"Korean",th:"Thai",ar:"Arabic"},translate:async function(text,sourceLang,targetLang){if(!text||!sourceLang||!targetLang){console.error("Missing required parameters for translation");return null;}const langPair=`${sourceLang}|${targetLang}`;const apiUrl=`https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=${langPair}`;try{const response=await fetch(apiUrl);const data=await response.json();if(data&&data.responseData&&data.responseData.translatedText){return data.responseData.translatedText;}else{console.error("Translation failed:",data);return null;}}catch(error){console.error("Translation API error:",error);return null;}},translatePage:async function(targetLang){if(targetLang==="en"){this.resetTranslation();return;}const sourceLang="en";const textNodes=this.getTextNodes(document.body);const translationPromises=[];const statusElement=document.createElement("div");statusElement.id="translation-status";statusElement.style.position="fixed";statusElement.style.bottom="70px";statusElement.style.right="20px";statusElement.style.backgroundColor="#1A365D";statusElement.style.color="#fff";statusElement.style.padding="10px 15px";statusElement.style.borderRadius="5px";statusElement.style.zIndex="1001";statusElement.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)";statusElement.textContent="Translating...";document.body.appendChild(statusElement);for(const node of textNodes){if(node.nodeValue.trim()){const originalText=node.nodeValue;translationPromises.push(this.translate(originalText,sourceLang,targetLang).then(translatedText=>{if(translatedText){node.originalText=node.originalText||originalText;node.nodeValue=translatedText;}}));}}await Promise.all(translationPromises);document.body.removeChild(statusElement);const languageSelector=document.getElementById("language-selector");if(languageSelector){languageSelector.style.display="none";}},resetTranslation:function(){const textNodes=this.getTextNodes(document.body);for(const node of textNodes){if(node.originalText){node.nodeValue=node.originalText;delete node.originalText;}}},getTextNodes:function(element){const textNodes=[];const walk=document.createTreeWalker(element,NodeFilter.SHOW_TEXT,{acceptNode:function(node){if(node.parentNode.tagName!=="SCRIPT"&&node.parentNode.tagName!=="STYLE"&&node.nodeValue.trim()){return NodeFilter.FILTER_ACCEPT;}return NodeFilter.FILTER_REJECT;}},false);let node;while(node=walk.nextNode()){textNodes.push(node);}return textNodes;}};const translationButton=document.getElementById("translation-button");const translateMenuLink=document.getElementById("translate-menu-link");const translateMobileLink=document.getElementById("translate-mobile-link");const languageSelector=document.getElementById("language-selector");const closeLanguageSelector=document.querySelector(".close-language-selector");const languageItems=document.querySelectorAll("#language-list li");if(translationButton){translationButton.addEventListener("click",function(){languageSelector.style.display=languageSelector.style.display==="block"?"none":"block";});}if(translateMenuLink){translateMenuLink.addEventListener("click",function(e){e.preventDefault();languageSelector.style.display=languageSelector.style.display==="block"?"none":"block";});}if(translateMobileLink){translateMobileLink.addEventListener("click",function(e){e.preventDefault();languageSelector.style.display=languageSelector.style.display==="block"?"none":"block";const mobileMenu=document.getElementById("mobile-menu");if(mobileMenu&&mobileMenu.classList.contains("hidden")===false){mobileMenu.classList.add("hidden");}});}if(closeLanguageSelector){closeLanguageSelector.addEventListener("click",function(){languageSelector.style.display="none";});}if(languageItems){languageItems.forEach(function(item){item.addEventListener("click",function(){const lang=this.getAttribute("data-lang");MyMemoryTranslator.translatePage(lang);});});}window.addEventListener("click",function(e){if(languageSelector&&e.target!==languageSelector&&!languageSelector.contains(e.target)&&e.target!==translationButton&&e.target!==translateMenuLink&&e.target!==translateMobileLink){languageSelector.style.display="none";}});});
