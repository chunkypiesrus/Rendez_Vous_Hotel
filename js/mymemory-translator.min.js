const MyMemoryTranslator={supportedLanguages:{en:"English",es:"Spanish",fr:"French",de:"German",it:"Italian",pt:"Portuguese",ru:"Russian",zh:"Chinese",ja:"Japanese",ko:"Korean",th:"Thai",ar:"Arabic"},translate:async function(text,sourceLang,targetLang){if(!text||!sourceLang||!targetLang){console.error("Missing required parameters for translation");return null;}const langPair=`${sourceLang}|${targetLang}`;const apiUrl=`https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=${langPair}`;try{const response=await fetch(apiUrl);const data=await response.json();if(data&&data.responseData&&data.responseData.translatedText){return data.responseData.translatedText;}else{console.error("Translation failed:",data);return null;}}catch(error){console.error("Translation API error:",error);return null;}},detectLanguage:function(text){return new Promise((resolve)=>{const langDetector=new google.translate.TranslateElement();langDetector.c.qb.Xc(text,(result)=>{resolve(result.src||"en");});});},initTranslationUI:function(){const translationButton=document.createElement("button");translationButton.id="translation-button";translationButton.className="translation-button";translationButton.innerHTML='<i class="fas fa-language"></i> Translate';translationButton.style.position="fixed";translationButton.style.bottom="20px";translationButton.style.right="20px";translationButton.style.zIndex="1000";translationButton.style.padding="10px 15px";translationButton.style.backgroundColor="#1A365D";translationButton.style.color="#fff";translationButton.style.border="none";translationButton.style.borderRadius="5px";translationButton.style.cursor="pointer";translationButton.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)";translationButton.addEventListener("click",this.showLanguageSelector.bind(this));document.body.appendChild(translationButton);},showLanguageSelector:function(){const existingSelector=document.getElementById("language-selector");if(existingSelector){existingSelector.style.display="block";return;}const languageSelector=document.createElement("div");languageSelector.id="language-selector";languageSelector.className="language-selector";languageSelector.style.position="fixed";languageSelector.style.bottom="70px";languageSelector.style.right="20px";languageSelector.style.zIndex="1000";languageSelector.style.backgroundColor="#fff";languageSelector.style.padding="15px";languageSelector.style.borderRadius="5px";languageSelector.style.boxShadow="0 2px 10px rgba(0,0,0,0.2)";languageSelector.style.maxHeight="300px";languageSelector.style.overflowY="auto";languageSelector.style.width="200px";const closeButton=document.createElement("button");closeButton.innerHTML="&times;";closeButton.style.position="absolute";closeButton.style.top="5px";closeButton.style.right="5px";closeButton.style.background="none";closeButton.style.border="none";closeButton.style.fontSize="20px";closeButton.style.cursor="pointer";closeButton.style.color="#333";closeButton.addEventListener("click",()=>{languageSelector.style.display="none";});languageSelector.appendChild(closeButton);const heading=document.createElement("h3");heading.textContent="Select Language";heading.style.margin="0 0 10px 0";heading.style.fontSize="16px";heading.style.color="#333";languageSelector.appendChild(heading);const languageList=document.createElement("ul");languageList.style.listStyle="none";languageList.style.padding="0";languageList.style.margin="0";for(const langCode in this.supportedLanguages){const langName=this.supportedLanguages[langCode];const langItem=document.createElement("li");langItem.style.padding="8px 10px";langItem.style.cursor="pointer";langItem.style.borderBottom="1px solid #eee";langItem.style.transition="background-color 0.2s";langItem.textContent=langName;langItem.addEventListener("mouseover",()=>{langItem.style.backgroundColor="#f5f5f5";});langItem.addEventListener("mouseout",()=>{langItem.style.backgroundColor="transparent";});langItem.addEventListener("click",()=>{this.translatePage(langCode);languageSelector.style.display="none";});languageList.appendChild(langItem);}languageSelector.appendChild(languageList);document.body.appendChild(languageSelector);},translatePage:async function(targetLang){const sourceLang="en";const textNodes=this.getTextNodes(document.body);const translationPromises=[];for(const node of textNodes){if(node.nodeValue.trim()){const originalText=node.nodeValue;translationPromises.push(this.translate(originalText,sourceLang,targetLang).then(translatedText=>{if(translatedText){node.originalText=node.originalText||originalText;node.nodeValue=translatedText;}}));}}await Promise.all(translationPromises);},getTextNodes:function(element){const textNodes=[];const walk=document.createTreeWalker(element,NodeFilter.SHOW_TEXT,{acceptNode:function(node){if(node.parentNode.tagName!=="SCRIPT"&&node.parentNode.tagName!=="STYLE"&&node.nodeValue.trim()){return NodeFilter.FILTER_ACCEPT;}return NodeFilter.FILTER_REJECT;}},false);let node;while(node=walk.nextNode()){textNodes.push(node);}return textNodes;}};document.addEventListener("DOMContentLoaded",function(){MyMemoryTranslator.initTranslationUI();});
